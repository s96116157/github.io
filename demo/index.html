<!doctype html>
<html lang="en">
<head>
    <title>Order</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link href="css/bootstrap-theme.min.css" rel="stylesheet" />
    <script src="js/bootstrap.min.js"></script>
    <script src="js/Chart.min.js"></script>
    <script src="js/Chart.bundle.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        // Load the Visualization API and the corechart package.
        google.charts.load('current', { 'packages': ['corechart'] });
        // Set a callback to run when the Google Visualization API is loaded.
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1X5Mtln-MYBhyBRn0RveNOXCkb32A4VTzht1AIGkNvdU/edit#gid=0');
            query.setQuery("SELECT A,C,D,E,F,G where B=1");
            query.send(handleQueryResponse);
            console.log('查詢Excel');
        }


        function handleQueryResponse(response) {
            if (response.isError()) {
                alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                return;
            }

            var data = response.getDataTable();
            var numrows = data.getNumberOfRows();
            var SYSID, Date, Item, Number, Price, Form_ID;
            console.log("response", response);
            console.log("data", data);
            console.log("numrows", numrows);
            var a = "";

            for (var row = 0; row < numrows; row++) {
                SYSID = data.getValue(row, 0);
                Date = data.getValue(row, 1);
                Item = data.getValue(row, 2);
                Number = data.getValue(row, 3);
                Price = data.getValue(row, 4);
                Form_ID = data.getValue(row, 5).toString();
                //var B = data.getValue(row, 1);
                //var name = data.getValue(row, 2);
                //var value = data.getValue(row, 3);

                a += '<tr><td>' + SYSID +
                    '</td><td>' + Date +
                    '</td>><td>' + Item +
                    '</td>><td>' + Number +
                    '</td>><td>' + Price +
                    '</td>><td>' + Form_ID +
                    '</td></tr>';
            }

            $("#table_001").append(a);
        }
    </script>

    <style>
        body {
            font-family: "Microsoft JhengHei",Helvetica,Arial,Verdana,sans-serif;
            color: white;
            font-size: 22px;
        }
    </style>
</head>
<body style="background-color: #333333;">
    <div style="margin: 10px;">
        <h1 style="color: white;">Checking your order</h1>
        <form>
            <br />
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>訂購日期</th>
                        <th>名稱</th>
                        <th>數量</th>
                        <th>價格</th>
                        <th>訂單編號</th>
                    </tr>
                </thead>
                <tbody id="table_001">
                </tbody>
            </table>
            <div>
                <div class="row show-grid">
                    <div class="col-xs-6 col-md-4">
                        <div class="chartjs-wrapper">
                            <iframe class="chartjs-hidden-iframe" tabindex="-1" style="display: block; overflow: hidden; border: 0px; margin: 0px; top: 0px; left: 0px; bottom: 0px; right: 0px; height: 100%; width: 100%; position: absolute; pointer-events: none; z-index: -1;"></iframe>
                            <canvas id="chartjs-4" class="chartjs" width="667" height="333" style="display: block; height: 267px; width: 534px;"></canvas>

                        </div>
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <div class="chartjs-wrapper">
                            <canvas id="chartjs-1" class="chartjs" width="656" height="327" style="display: block; height: 262px; width: 525px;"></canvas>
                        </div>
                    </div>

                    <div class="col-xs-6 col-md-4"></div>
                </div>

            </div>

            <table style="color: white;"></table>
            <input type="button" class="btn btn-primary" value="A" onclick="Show_Value()">
            <input type="button" class="btn btn-primary" value="B" onclick="Destroy_Value()">
        </form>
    </div>
    <script type="text/javascript">
        function Destroy_Value() {
            new Chart(document.getElementById("chartjs-4"),
                    {
                        "type": "doughnut", "data": {
                            "labels": ["A", "B", "C"],
                            "datasets": [{
                                "label": "My First Dataset", "data": [100, 150, 20],
                                "backgroundColor": ["rgb(255, 99, 132)", "rgb(54, 162, 235)", "rgb(255, 205, 86)"]
                            }]
                        }
                    });
        };

        function Show_Value() {
            new Chart(document.getElementById("chartjs-4"),
                {
                    "type": "doughnut", "data": {
                        "labels": ["Red", "Blue", "Yellow"],
                        "datasets": [{
                            "label": "My First Dataset", "data": [300, 50, 100],
                            "backgroundColor": ["rgb(255, 99, 132)", "rgb(54, 162, 235)", "rgb(255, 205, 86)"]
                        }]
                    }
                });
            new Chart(document.getElementById("chartjs-1"),
                {
                    "type": "bar", "data": {
                        "labels": ["January", "February", "March", "April", "May", "June", "July"],
                        "datasets": [{
                            "label": "My First Dataset", "data": [65, 59, 80, 81, 56, 55, 40], "fill": false,
                            "backgroundColor": ["rgba(255, 99, 132, 0.2)", "rgba(255, 159, 64, 0.2)", "rgba(255, 205, 86, 0.2)", "rgba(75, 192, 192, 0.2)", "rgba(54, 162, 235, 0.2)", "rgba(153, 102, 255, 0.2)", "rgba(201, 203, 207, 0.2)"],
                            "borderColor": ["rgb(255, 99, 132)", "rgb(255, 159, 64)", "rgb(255, 205, 86)", "rgb(75, 192, 192)", "rgb(54, 162, 235)", "rgb(153, 102, 255)", "rgb(201, 203, 207)"],
                            "borderWidth": 1
                        }]
                    }, "options": {
                        "scales": {
                            "yAxes": [{
                                "ticks": {
                                    "beginAtZero": true
                                }
                            }]
                        }
                    }
                });
        }
    </script>
</body>
</html>
